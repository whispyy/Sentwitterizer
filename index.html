<!DOCTYPE html>
<html>
<title>Rapport PJE : Twitter Sentiment Analyzer</title>
<meta charset="UTF-8"/>
<xmp theme="united" style="display:none;">
<div class="corner-ribbon top-right black"><a href="rapport.pdf">Version PDF</a></div>
<img style="float: right;" src="img/logoLille1.png">
# Rapport PJE
# Twitter Sentiment Analyzer
Julien Leclercq & Jean-Fr√©d√©ric Durand

<a href="http://github.com/Sentwitter/TwitterSentimentAnalyzer" target="_blank">Lien vers le GitHub</a>
<b>|</b>
<a href="http://52.31.122.230" target="_blank">Lien vers l'application</a>

<div class="jfborder"></div>
## Sommaire

 * ### Pr√©sentation du projet
   * #### I / Probl√©matique
   * #### II / Architecture de l'application
 * ### D√©tails des travaux effectu√©s
   * #### I / API Twitter
   * #### II / Base d'apprentissage
   * #### III / Algorithmes de classifications
   * #### IV / Interface graphique
   * #### V / Conclusion
 * ### Glossaire


<div class="jfborder"></div>
## Pr√©sentation du projet

### I / Probl√©matique

#### Objectif
L'objectif de ce PJE est de mani√®re globale d'analyser l'attitude d'un tweet, en fonction de son contenu. √âtant dans la r√©gion Nord, Pas-de-Calais et proche de la Belgique, nous avons estim√© que culturellement parlant faire une analyse autours du sujet qu'est la bi√®re et les frites nous permettrait de r√©v√©ler l'attitude d'une majorit√© de tweets "locaux".
Notre objectif est aussi de comparer les diff√©rents algorithmes de classification.

#### Notion de classification
Lors de ce PJE la classification s'est faite selon la norme suivante. Lors de la r√©cup√©ration des tweets on index un nombre √† -1.
Une fois annot√© il se verra affect√© un nombre : 0, 1, 2 si le tweet est respectivement n√©gatif, neutre ou positif.
Par la suite ce classement nous permettra de cat√©goriser les tweets √† vis√©e positive, n√©gative ou neutre par l'interm√©diaire des diff√©rents algorithmes propos√©s.

#### Marge d'erreur
La classification automatique n'est cependant pas parfaite. En effet il est tr√®s difficile de classifier certains tweets tel que les tweets √† connotation sarcastique par exemple; ou encore l'ironie √©tant donn√© que ces types de tweets sont s√©mantiquement tr√®s proche des tweets ayant une vis√©e au premier degr√©.

### II / Architecture de l'application

#### Paquetage
Le projet r√©alis√© a √©t√© d√©velopp√© en Ruby on rails avec les paquets suivant :

 - Base de donn√©e : SQLITE3
 - HTML : Slim
 - CSS : Bootstrap
 - API : Twitter (for ruby on rails)

D'autres paquets ont √©t√© utilis√©s pour nous simplifier la r√©alisation de l'interface graphique. Ces paquets sont list√©s dans le "Gemfile" √† la racine du projet. 

#### Mod√®le de conception
Pour ce projet nous avons opt√© pour un mod√®le _MVC_ natif et repr√©sentatif de l'environnement Ruby. Il sera ainsi facile de retrouver les principales classes dans le mod√®le. 
Les classes sont :
 - TweetSearch : Classe de gestion des recherches de tweets
 - TweetAnalysis : Classe de gestion des analyses de classification
 - KeywordsAnalysis : Classe de la fonction de classification par mots-cl√©s
 - KnnAnalysis : Classe de la fonction de classification par Knn
 - Bayes : Classe de la fonction de classification par Bayes

Pour le cas de l'enregistrement en base et de la lecture, nous fonctionnant en _ActiveRecord_. Ceci nous permet de faire beaucoup de requ√™te et de les modifier par la suite simplement.



<div class="jfborder"></div>
## D√©tails des travaux effectu√©s

### I / API Twitter
Premi√®rement, on a configur√© le client de l'API twitter dans un contr√¥leur d'initialisation : 
app/controllers/concerns/application_concern.rb.

Deuxi√®mement, √† l'aide du tweet_search_controller.rb nous effectuons une requ√™te d'envoi de recherche de tweet via un param√®tre de recherche. Ce param√®tre de recherche peut √™tre un mot,un pseudo ou encore un groupe de mots.
Il est √† noter que nous avons d√©fini la langue lors de l'envoi de la requ√™te, nous ne r√©cup√©rons donc que les tweets en fran√ßais.
La m√©thode "create" nous permet quant-√† elle d'effectuer la requ√™te via l'API et d'enregistrer ces donn√©es en base.
Il est √©galement important de souligner que nous avons d√©fini un crit√®re de recherche compl√©mentaire : Le nombre de tweets √† enregistrer par recherche. En effet si nous ne limitons pas le nombre de tweet comprenant le mot cl√©s, celle-ci peut s'av√©rer tr√®s longue et lourde √† rentrer en base.

### II / Base d'apprentissage

#### Nettoyage des donn√©es
Le nettoyage des tweets s'effectue dans le repertoire : app/models/tweets.rb.
On y retrouve les principales fonctions de suppression qui sont :

 - remove_url : Supprime un lien url fournit dans un tweet
 - remove_rt : Supprime les caract√®res "RT" lors d'un retweet
 - remove_arobase : Supprime les @ d'un tweet
 - remove_hashtag : Supprime les # d'un tweet
 - remove_quotes : Supprime les guillemets d'un tweet

S'ajoute √† cela quelques transformations :

 - transform_price : Transforme un prix en euro par X
 - different_smiley : Suppression des smiley positif et n√©gatif lorsqu'ils sont regroup√©s dans un m√™me tweets

#### Construction de la base

##### Table de Tweets
La construction de la base est visible depuis le r√©pertoire db/schema.rb du projet.
Nous y d√©finissons la cr√©ation de la table de stockage d'un tweet selon les crit√®res suivants :

 - tweet_id : l'identifiant twitter du tweet
 - twittos : la personne qui a publi√© le tweet
 - text : le corps du tweet
 - annotation : l'entier d√©fini pour la classification
 - created_at : date de cr√©ation dans la base
 - updated_at : date de mise a jour dans la base
 - hand_annoted : un boolean qui renvoie vrai si le tweet √† √©t√© annot√© √† la main
 - tweet_search_id : l'identifiant de la recherche qui nous permet de trier les tweets par recherche.

A noter que nous avons du augmenter la taille des entier par d√©faut de sqlite3 √† 20.En effet le tweet_id √† actuellement une longueur de 18 caract√®res.

De plus nous avons d√©fini les les donn√©es de dates (created_at,updated_at) comme facultatives.

##### Table de recherches

Une deuxi√®me table nous permet de sauvegarder les recherches pr√©c√©demment effectu√©es. Cette table s'appelle tweet_searches et contient :

 - full_text : Le nom de la recherche entr√©
 - created_at : date de cr√©ation dans la base
 - updated_at : date de mise a jour dans la base

L'objectif de cette table de recherche est premi√®rement de sauvegarder nos recherches pour y acc√©der plus tard, mais surtout de nous permettre de mettre √† jour les recherches par la suite.

##### Table d'analyses

Une troisi√®me table nous permet de sauvegarder les analyses effectu√©s sur les recherches. Cette table s'appelle tweet_analyses et est contitu√© des attributs suivants :

 - tweet_search_id : l'identifant de recherche des tweets.
 - type : le type d'analyse effectu√© 
 - neutral_tweets : nombre de tweets neutres
 - positive_tweets : nombre de tweets positif
 - negative_tweets : nombre de tweets n√©gatif
 - last_performed : Date de derni√®re analyse

### III / Algorithmes de classifications

#### Mots-cl√©s
Nous avons r√©cup√©r√© les fichiers positif.txt et negatif.txt que vous trouverez dans lib/tasks sous les noms positive_word.rb et negative_word.rb contenant la liste des mots-cl√©s mise en forme pour Ruby.

L'algorithme est simple on va effectuer une boucle sur tous les Tweets de la base en recherchant les mots cl√©s du tableau. Lorsqu'un mot cl√© est trouv√© on augmente sa cardinalit√© s'il est positif et on l'a baisse s'il est n√©gatif.

Nous avons fait une petite analyse des tweets par mots-cl√©s et avons remarqu√© que pas mal d'entres eux comportaient des √©moticones "sp√©ciales". Nous avons donc ajout√© √† la liste ceux que nous avons retrouv√© la correspondance UTF-8.

| Symbole | Code | UTF-8 | Nom | Annotation |
|---|---|---|---|---|
| üëç | 1F44D | F0 9F 91 8D | THUMBS UP SIGN | Positif |
| üíã | 1F48B | F0 9F 92 8B | KISS MARK | Positif |
| üéâ | 1F389 | F0 9F 8E 89 |¬†PARTY POPPER | Positif |
| üçª | 1F37B | F0 9F 8D BB |¬†CLINKING BEER MUGS  | Positif |
| üëå | 1F44C | F0 9F 91 8C | OK HAND SIGN | Positif |
|¬†üòç | 1F60D | F0 9F 98 8D | SMILING FACE WITH HEART-SHAPED EYES | Positif |
| üòÇ | 1F602 | F0 9F 98 82 | FACE WITH TEARS OF JOY | Positif |
| ‚ù§ | 2764 | E2 9D A4 | HEAVY BLACK HEART | Positif |
| üíØ | 1F4AF | F0 9F 92 AF | HUNDRED POINTS SYMBOL | Positif |
| üòâ | 1F609 | F0 9F 98 89 | WINKING FACE |¬†Positif |
| üòá | 1F607 | F0 9F 98 87 |¬†SMILING FACE WITH HALO | Positif |
| üòè | 1F60F | F0 9F 98 8F | SMIRKING FACE | Positif |
| üò® | 1F628 | F0 9F 98 A8 |¬†FEARFUL FACE | Negatif |
| üòí |¬†1F612 | F0 9F 98 92 | UNAMUSED FACE | Negatif |
| üòÅ | 1F601 | F0 9F 98 81 | GRINNING FACE WITH SMILING EYES | Positif |

#### KNN

##### Mesures de distances
On va rechercher les distances entre les tweets. 
La fonction renvoie un tableau de distances.

##### Le plus proche voisin
Le calcul du plus proche voisin effectue une recherche parmis les distances d√©finies par la mesure des distances.

#### Bayes

### IV / Interface graphique

mettre des copies d'√©crans et d√©crire l'utilisation


### V / Conclusion
Ce projet nous a permis de d√©couvrir une approche du "machine learning" et du "big data". En effet nous avons pu par l'interm√©diaire des diff√©rents algorithmes, mettre en oeuvre une classification. De plus nous avons d√©couvert la limite de ces algorithmes, notamment d√ªe √† la complexit√© du langage qu'est le fran√ßais.

<div class="jfborder"></div>
## Glossaire

_MVC_ : Model-View-Controller est un patron d'architecture logicielle permettant de r√©pondre aux besoins d'une application interactive. Les fonctions sont r√©parties en trois parties :

 * un Mod√®le de donn√©es permettant de traiter des donn√©es provenant de la base
 * une Vue repr√©sentant l'interface de utilisateur
 * un Contr√¥leur permettant de faire la liaison entre le Mod√®le et la vue

_ActiveRecord_ : Encapsulage des donn√©es dans une classe pour la lecture ou l'√©criture de donn√©es en base. Lorsque l'on met √† jour un objet, son objet en base aussi. De plus la classe impl√©mente des accesseurs pour chaque attribut.
</xmp>

<script src="http://strapdownjs.com/v/0.2/strapdown.js"></script>

</html>
<style>
html{
  overflow-x: hidden;
}

.jfborder{
	border: solid 1px grey;
}

.corner-ribbon{
  z-index: 30;
  width: 200px;
  background: #e43;
  position: absolute;
  top: 25px;
  left: -50px;
  text-align: center;
  line-height: 50px;
  letter-spacing: 1px;
  color: #f0f0f0;
  transform: rotate(-45deg);
  -webkit-transform: rotate(-45deg);
}

.corner-ribbon.sticky{
  position: fixed;
}

.corner-ribbon.top-right{
  top: 25px;
  right: -50px;
  left: auto;
  transform: rotate(45deg);
  -webkit-transform: rotate(45deg);
}

.corner-ribbon.white{background: #f0f0f0; color: #555;}
.corner-ribbon.black{background: #333;}
.corner-ribbon.grey{background: #999;}
.corner-ribbon.blue{background: #39d;}
.corner-ribbon.green{background: #2c7;}
.corner-ribbon.turquoise{background: #1b9;}
.corner-ribbon.purple{background: #95b;}
.corner-ribbon.red{background: #e43;}
.corner-ribbon.orange{background: #e82;}
.corner-ribbon.yellow{background: #ec0;}
</style>